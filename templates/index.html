<!doctype html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Fine Dining Coach – Free Menu Analyzer</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <link rel="stylesheet" href="/static/styles.css">
</head>
<body class="bg-zinc-50 text-zinc-900 dark:bg-zinc-900 dark:text-zinc-100">
  <div class="max-w-5xl mx-auto p-4">
    <header class="mb-6">
      <h1 class="text-3xl font-bold">Fine Dining Coach – Free Menu Analyzer</h1>
      <p class="text-sm opacity-75">Deterministic rules. No paid APIs. Works great embedded.</p>
      <button id="darkToggle" class="mt-2 text-xs underline">Toggle dark mode</button>
    </header>

    <main class="grid md:grid-cols-2 gap-4">
      <!-- ZIP search -->
      <section class="p-4 rounded-2xl shadow bg-white dark:bg-zinc-800">
        <h2 class="text-xl font-semibold mb-2">Find healthy picks by ZIP</h2>
        <form id="zipForm" class="space-y-2">
          <div class="flex gap-2">
            <input id="zip" required maxlength="5" pattern="\d{5}" class="input" placeholder="ZIP e.g., 80202">
            <input id="radius" type="number" min="1" max="10" value="3" class="input w-24" placeholder="mi">
          </div>
          <div class="flex items-center gap-2 text-sm">
            <label class="flex items-center gap-1"><input type="checkbox" id="onlyChains"> Only show chains</label>
          </div>
          <div class="text-sm flex gap-2 flex-wrap">
            <button class="btn" type="submit">Search</button>
            <span class="pill" id="presetCut">Cut 600 kcal</span>
            <span class="pill" id="presetMaintain">Maintain 750 kcal</span>
            <span class="pill" id="presetHighP">High-Protein 40–60 g</span>
          </div>
        </form>
        <div id="zipResults" class="mt-3 space-y-3"></div>
      </section>

      <!-- Analyzer -->
      <section class="p-4 rounded-2xl shadow bg-white dark:bg-zinc-800">
        <h2 class="text-xl font-semibold mb-2">Analyze a menu (URL or PDF)</h2>
        <form id="analyzeUrlForm" class="space-y-2">
          <input id="menuUrl" class="input" placeholder="Paste a menu URL (http/https)">
          <div class="flex gap-2 text-sm">
            <label class="flex items-center gap-1"><input type="checkbox" id="prioritizeProtein" checked> Prioritize protein</label>
            <label class="flex items-center gap-1"><input type="checkbox" id="lowCarb"> Low-carb</label>
            <label class="flex items-center gap-1"><input type="checkbox" id="noFried"> No fried</label>
          </div>
          <div class="flex items-center gap-2">
            <label class="text-sm">Calorie target per meal</label>
            <input id="calTarget" type="number" value="600" class="input w-28">
          </div>
          <button class="btn" type="submit">Analyze URL</button>
        </form>

        <div class="mt-3">
          <form id="pdfForm" enctype="multipart/form-data" class="space-y-2">
            <input id="pdfFile" type="file" accept="application/pdf" class="block text-sm">
            <label class="flex items-center gap-1 text-sm"><input type="checkbox" id="enableOCR"> Enable OCR if needed (requires Tesseract on server)</label>
            <button class="btn" type="submit">Analyze PDF</button>
          </form>
        </div>

        <div class="mt-3">
          <label class="text-sm">Open Food Facts lookup</label>
          <div class="flex gap-2">
            <input id="offQuery" class="input" placeholder="e.g., keto tortilla">
            <button id="offBtn" class="btn" type="button">Search</button>
          </div>
          <div id="offResults" class="mt-2 text-sm"></div>
        </div>
      </section>
    </main>

    <section class="mt-6 p-4 rounded-2xl bg-white dark:bg-zinc-800 shadow">
      <h3 class="font-semibold">How it works</h3>
      <p class="text-sm opacity-80">We parse menus deterministically, estimate calories and protein with transparent rules, and suggest server-friendly modifiers. For location discovery we use OpenStreetMap.</p>
      <details class="mt-2">
        <summary class="cursor-pointer text-sm underline">Embed in your portal (responsive)</summary>
        <pre class="text-xs bg-zinc-100 dark:bg-zinc-900 p-2 rounded">
&lt;iframe src="YOUR_RENDER_URL" width="100%" style="border:0" id="fdc-iframe"&gt;&lt;/iframe&gt;
&lt;script&gt;
window.addEventListener("message", (e)=>{
  if(e.data && e.data.type==="fdc-resize"){ 
    document.getElementById("fdc-iframe").style.height = e.data.height+"px";
  }
});
&lt;/script&gt;</pre>
      </details>
    </section>

    <footer class="mt-6 text-xs opacity-70">
      © OpenStreetMap contributors. Geocoding by <a class="underline" href="https://nominatim.openstreetmap.org">Nominatim</a>. Data via <a class="underline" href="https://overpass-api.de/">Overpass API</a>. Packaged items from <a class="underline" href="https://world.openfoodfacts.org/">Open Food Facts</a>.
    </footer>
  </div>
  <script src="/static/app.js"></script>
</body>
</html>
